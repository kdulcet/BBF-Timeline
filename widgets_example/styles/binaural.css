/* ============================================================================
   BINAURAL WIDGET STYLES
   ============================================================================
   Widget-specific CSS for the binaural beat control panel.
   
   ARCHITECTURE:
   - Extends base widget styles from styles/ui_elements.css
   - Overrides generic rules for binaural-specific layout
   - Uses control-grid system for control arrangement
   - Implements pagination for expandable content areas
   
   LAYOUT STRUCTURE:
   ┌─────────────────────────────────────────┐
   │  .control-panel-binaural (container)    │
   │  ┌───────────────────────────────────┐  │
   │  │ .binaural-widget                  │  │
   │  │  ┌─────────────────────────────┐  │  │
   │  │  │ .control-panel-top-row      │  │  │ ← Root/Mood selectors
   │  │  │ (Root, Mood)                │  │  │
   │  │  └─────────────────────────────┘  │  │
   │  │  ┌─────────────────────────────┐  │  │
   │  │  │ .binaural-middle-section    │  │  │
   │  │  │  ┌──────────────────────┐   │  │  │
   │  │  │  │ .binaural-content-box│   │  │  │ ← Paginated content
   │  │  │  │ (Nav, Pages)         │   │  │  │
   │  │  │  └──────────────────────┘   │  │  │
   │  │  │  ┌──────────────────────┐   │  │  │
   │  │  │  │ .binaural-faders-row │   │  │  │ ← 5 voice volume faders
   │  │  │  │ (5 faders)           │   │  │  │
   │  │  │  └──────────────────────┘   │  │  │
   │  │  └─────────────────────────────┘  │  │
   │  │  ┌─────────────────────────────┐  │  │
   │  │  │ .control-panel-bottom-row   │  │  │ ← Save/Preset/Revert
   │  │  │ (Preset controls)           │  │  │
   │  │  └─────────────────────────────┘  │  │
   │  └───────────────────────────────────┘  │
   └─────────────────────────────────────────┘
   
   CSS INTEGRATION:
   - Base styles: styles/ui_elements.css (.control-panel, .ui-base, etc.)
   - Widget chrome: Generic white panel with shadow
   - Control layout: .control-grid system from ui_elements.css
   - This file: Binaural-specific overrides and unique elements
   
   INHERITANCE CHAIN:
   1. styles/base.css → CSS variables, resets
   2. styles/ui_elements.css → Generic widget/control styles
   3. THIS FILE → Binaural-specific layout and controls
   ============================================================================ */

/* ==============================================
   CONTAINER ISOLATION
   ==============================================
   Force separate GPU compositing layer to prevent
   GLSL shader interference with UI elements.
   ============================================== */
.control-panel-binaural {
  position: relative;
  z-index: 9999;
  transform: translate3d(0, 0, 0);
  isolation: isolate;
  contain: strict;
  mix-blend-mode: normal;
  filter: opacity(1);
  overflow: visible;
}

/* Force all interactive elements onto separate compositing layers */
/* Force all interactive elements onto separate compositing layers */
body #control-panel-binaural.ui-base .binaural-widget .button_selector.button_selector,
body #control-panel-binaural.ui-base .binaural-widget .button_selector__nav.button_selector__nav,
body #control-panel-binaural.ui-base .binaural-widget .button_selector__display.button_selector__display,
body #control-panel-binaural.ui-base .binaural-widget .ui-btn.ui-btn,
body #control-panel-binaural.ui-base .binaural-widget .fader-handle.fader-handle {
  position: relative;
  z-index: 1000;
  transform: translate3d(0, 0, 0);
  transform-style: preserve-3d;
  will-change: transform, box-shadow;
  isolation: isolate;
  backdrop-filter: blur(0);
  contain: layout style paint;
  opacity: 1.0;
  background-color: rgba(255, 255, 255, 1.0);
}

/* Layout containers have no shadows (only interactive elements) */
/* Layout containers have no shadows (only interactive elements) */
.control-panel-binaural .binaural-widget .binaural-faders-row {
  box-shadow: none !important;
}

/* ==============================================
   DEBUG VISIBILITY CONTROLS
   ==============================================
   CSS-level element hiding via data attributes.
   Controlled by UI Debug system.
   
   BINAURAL WIDGET STRUCTURE:
   - data-debug-panel-bg → .control-panel (white panel container)
   - data-debug-binaural-controls → .control-panel-top-row (Root/Mood selectors)
   - data-debug-binaural-presets → .control-panel-bottom-row (Save/Preset/Revert)
   
   ROW DEFINITIONS:
   - TOP ROW: Root/Mood selectors = "Binaural Controls"
   - MIDDLE: Content box + faders (always visible when panel visible)
   - BOTTOM ROW: Save/Preset/Revert = "Binaural Presets"
   
   DEFAULT STATE: Controls and presets hidden by default
   ============================================== */


/* Hide panel container */
[data-debug-panel-bg="hidden"] .control-panel-binaural {
  display: none !important;
}

/* Hide control row */
[data-debug-binaural-controls="hidden"] .control-panel-top-row {
  display: none !important;
}

/* Hide preset row */
[data-debug-binaural-presets="hidden"] .control-panel-bottom-row {
  display: none !important;
}

/* Default state: controls and presets hidden */
.binaural-widget .control-panel-top-row {
  display: none;
}

.binaural-widget .control-panel-bottom-row {
  display: none;
}

/* Show when explicitly visible */
[data-debug-binaural-controls="visible"] .control-panel-top-row {
  display: flex !important;
}

[data-debug-binaural-presets="visible"] .control-panel-bottom-row {
  display: flex !important;
}

/* Granular control: Show controls only (no presets) */
[data-debug-visibility="controls-only"] .control-panel-top-row {
  display: flex;
}

[data-debug-visibility="controls-only"] .control-panel-bottom-row {
  display: none;
}

/* ==============================================
   WIDGET CONTAINER
   ==============================================
   Base container for binaural widget content.
   Extends .control-panel from ui_elements.css.
   ============================================== */
/* ==============================================
   WIDGET CONTAINER
   ==============================================
   Base container for binaural widget content.
   Extends .control-panel from ui_elements.css.
   ============================================== */

/* Binaural widget inside generic control-panel */
.control-panel-binaural .binaural-widget {
    padding: 0;
    position: relative;
    width: 100%;
    height: 100%;
    min-height: 8rem;
    flex: 1;
    border: none;
    box-shadow: none;
    background: transparent;
    border-radius: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: flex-start;
}

/* Legacy standalone widget (not inside .control-panel) */
.binaural-widget {
   padding: 0;
   margin: 0;
   position: relative;
   width: 99%;
   flex: 1 1 auto;
   height: auto;
   min-height: 8rem;
   background-color: #ffffff;
   border: 0.125rem solid #000;
   border-radius: 0.625rem;
   box-shadow: 0 0.375rem 1.125rem rgba(0,0,0,0.12);
   display: flex;
   flex-direction: column;
   justify-content: flex-start;
   align-items: flex-start;
}

/* Selector-specific button hiding */
/* Selector-specific button hiding */
.binaural_selector button {
    display: none;
}

/* ==============================================
   TOP ROW (ROOT/MOOD SELECTORS)
   ==============================================
   Binaural-specific overrides for selector row.
   ============================================== */
.binaural-widget .control-panel-top-row {
    justify-content: center;
    gap: -0.00rem;
    font-size: 0.8em;
    flex: 0 0 auto;
    margin: 0 auto .55rem auto;
    order: 0;
}

/* Reduce height for all ui-base elements in top row */
/* Reduce height for all ui-base elements in top row */
.binaural-widget .control-panel-top-row .ui-base {
    height: 1.8rem;
    line-height: 1.8rem;
}

/* ==============================================
   MIDDLE SECTION (CONTENT BOX + FADERS)
   ==============================================
   Expandable content area with pagination + voice faders.
   Takes all available space between top and bottom rows.
   ============================================== */
/* Middle section container */
.binaural-middle-section {
    display: flex;
    flex-direction: column;
    flex: 1;
    gap: 0.0rem;
    order: 1;
    width: calc(100%);
}

/* Content box with pagination */
/* Content box with pagination */
.binaural-content-box {
    width: 100%;
    flex: 1;
    padding: 0.25rem;
    display: flex;
    justify-content: center;
    align-items: center;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 0.375rem;
    box-shadow: var(--control-panel-shadow) !important;
    position: relative;
}

/* Navigation buttons (absolute positioned in corners) */
/* Navigation buttons (absolute positioned in corners) */
.binaural-content-box .binaural-nav-left {
    position: absolute;
    left: 0.25rem;
    top: 50%;
    transform: translateY(-50%);
    width: 1.7em;
    height: 1.7em;
    font-size: 0.64em;
}

.binaural-content-box .binaural-nav-right {
    position: absolute;
    right: 0.25rem;
    top: 50%;
    transform: translateY(-50%);
    width: 1.7em;
    height: 1.7em;
    font-size: 0.64em;
}

/* Content area (space between nav buttons) */
/* Content area (space between nav buttons) */
.binaural-content-area {
    flex: 1;
    height: 100%;
    border: 0px solid #ccc;
    border-radius: 0.25rem;
    margin: 0 0.5rem;
    position: relative;
}

/* Page number indicator (top-right corner) */
/* Page number indicator (top-right corner) */
.binaural-page-number {
    position: absolute;
    top: 0.1rem;
    right: -.45rem;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    font-size: 0.75rem;
    font-weight: bold;
    padding: 0.0525rem 0.010rem;
    border-radius: 0.125rem;
    z-index: 10;
    width: 1.7em;
    text-align: center;
    line-height: 1.2;
}

/* ==============================================
   PAGINATION SYSTEM
   ==============================================
   Multi-page content system for expandable controls.
   Pages switched via navigation buttons.
   ============================================== */

/* Page containers (hidden by default) */
/* Page containers (hidden by default) */
.binaural-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: none;
    padding: 0;
    box-sizing: border-box;
}

/* Active page display */
.binaural-page.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Page content styling */
.binaural-page .page-content {
    text-align: center;
    font-size: 1rem;
    color: #333;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
}

/* Octave label styling */
.octave-label {
    font-size: 0.65rem;
    font-weight: 500;
    color: #333;
    min-width: 1.5rem;
}

/* ==============================================
   BOTTOM ROW (PRESET CONTROLS)
   ==============================================
   Save/Load/Revert preset controls.
   ============================================== */
/* ==============================================
   BOTTOM ROW (PRESET CONTROLS)
   ==============================================
   Save/Load/Revert preset controls.
   ============================================== */

.binaural-widget .control-panel-bottom-row {
    order: 2;
}

/* Preset control containers */
.root-selector-container,
.mood-selector-container,
.binaural-preset-container {
    display: flex;
    align-items: center;
    gap: 0.65rem;
}

/* ==============================================
   SELECTOR OVERRIDES
   ==============================================
   Binaural-specific sizing for button selectors.
   ============================================== */
/* ==============================================
   SELECTOR OVERRIDES
   ==============================================
   Binaural-specific sizing for button selectors.
   ============================================== */

/* Button selector sizing */
.control-panel-binaural .binaural-widget .button_selector {
    font-size: 0.8em;
}

/* Navigation button sizing */
.control-panel-binaural .binaural-widget .button_selector .button_selector__nav {
    font-size: 0.9em;
    width: 1.8em;
    height: 1.8em;
}

/* Root selector display width */
/* Root selector display width */
.root-selector-container .button_selector .button_selector__display {
    font-size: inherit;
    min-width: 1.35rem;
    max-width: 1.35rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Mood selector display width */
.mood-selector-container .button_selector .button_selector__display {
    font-size: inherit;
    min-width: 3.35rem;
    max-width: 3.35rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Label styling for top row */
/* Label styling for top row */
.binaural-widget .control-panel-top-row .root-label,
.binaural-widget .control-panel-top-row .mood-label {
    font-size: 0.8em;
    margin-right: -.30rem;
    flex-shrink: 0;
}

/* Top row selector styling */
/* Top row selector styling */
.binaural-widget .control-panel-top-row .button_selector {
    font-size: 0.8em;
    margin: 0;
    flex-shrink: 0;
}

/* Preset selector sizing */
/* Preset selector sizing */
.button_selector--preset {
    min-height: 1.7em;
    line-height: 1.7em;
}

/* Binaural presets layout */
/* Binaural presets layout */
.binaural-presets {
    display: inline-flex;
    align-items: center;
    gap: 0.65rem;
    margin: 0 auto;
}

/* ==============================================
   VOICE VOLUME FADERS
   ==============================================
   5 vertical faders for voice volume control.
   Positioned above bottom row, scaled 90% for compact layout.
   ============================================== */


/* Faders row container */
.binaural-faders-row {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    margin-bottom:.5em;
    padding: 0.8em 1.0em;
    gap: 1.0em;
    flex: 1;
    width: fit-content;
    height: auto;
    line-height: normal;
    transform: scale(0.9);
    transform-origin: left bottom;
}

/* Left-align faders within flex parent */
/* Left-align faders within flex parent */
.control-panel-binaural .binaural-widget {
    align-items: flex-start;
}

/* Higher specificity for faders row alignment */
/* Higher specificity for faders row alignment */
.control-panel-binaural .binaural-widget .binaural-faders-row {
    align-self: flex-start;
    margin-left: 0;
    margin-right: auto;
    margin-top: auto;
    margin-bottom: 0.5em;
}

/* Individual voice fader */
.voice-fader {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    max-width: 2em;
}

/* Vertical fader track */
.fader-track {
    position: relative;
    width: 0.075rem;
    height: 3.6em;
    background-color: #000000;
    border-radius: 0.15rem 0.15rem 0 0;
    cursor: pointer;
    margin-bottom: 0.5em;
    opacity: 1.0;
}

/* Fader handle (draggable circle) */
.fader-handle {
    position: absolute;
    width: 0.675rem;
    height: 0.675rem;
    background-color: #000000;
    border-radius: 50%;
    left: 50%;
    transform: translateX(-50%);
    cursor: grab;
    box-shadow: var(--control-panel-shadow);
    transition: transform 0.1s ease;
    opacity: 1.0;
}

/* Fader handle hover state */
.fader-handle:hover {
    transform: translateX(-50%) scale(1.1);
}

/* Fader handle active (dragging) state */
.fader-handle:active {
    cursor: grabbing;
    transform: translateX(-50%) scale(0.95);
}

/* Voice label below fader */
.voice-label {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 0.9em;
    color: #000000;
    font-weight: 700;
    user-select: none;
    text-align: center;
}

/* ==============================================
   CONTROL GRID WIDGETS (OCTAVE + WIDTH)
   ==============================================
   Page 1 controls in binaural content box.
   Uses .control-grid system from ui_elements.css.
   ============================================== */

/* Octave label alignment */
.octave-label {
    position: relative;
    top: 0.1rem;
}

/* Octave widget container */
/* Octave widget container */
.octave-widget {
    position: relative;
}

/* Octave widget base line (horizontal) */
.octave-widget::before {
    content: '';
    position: absolute;
    bottom: 0.625rem;
    left: 0;
    width: 3.4rem;
    height: 0.075rem;
    background: #333;
}

/* Octave widget tick marks (vertical lines) */
.octave-widget::after {
    content: '';
    position: absolute;
    bottom: 0.25rem;
    left: 0;
    width: 3.4rem;
    height: 0.75rem;
    background: 
        linear-gradient(90deg, #333 0rem, #333 0.075rem, transparent 0.075rem) 0rem 0rem / 0.075rem 0.75rem no-repeat,
        linear-gradient(90deg, #333 0rem, #333 0.075rem, transparent 0.075rem) 0.8rem 0.1rem / 0.9rem 0.55rem no-repeat,
        linear-gradient(90deg, #333 0rem, #333 0.075rem, transparent 0.075rem) 1.65rem 0rem / 0.075rem 0.75rem no-repeat,
        linear-gradient(90deg, #333 0rem, #333 0.075rem, transparent 0.075rem) 2.5rem 0.1rem / 0.9rem 0.55rem no-repeat,
        linear-gradient(90deg, #333 0rem, #333 0.075rem, transparent 0.075rem) 3.325rem 0rem / 0.075rem 0.75rem no-repeat;
}

/* Octave button (clickable hitbox) */
.octave-btn {
    position: absolute;
    bottom: 0;
    width: 1rem;
    height: 1.25rem;
    background: transparent;
    border: none;
    cursor: pointer;
    z-index: 100;
}

/* Active octave indicator (filled circle) */
.octave-btn.active::after {
    content: '';
    position: absolute;
    top: 0.6rem;
    left: 51%;
    width: 0.4rem;
    height: 0.4rem;
    background: #000;
    border-radius: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    pointer-events: none;
}

/* Octave button positioning (5 positions for -2 to +2) */
.octave-btn[data-oct="-2"] { left: -0.4625rem; }
.octave-btn[data-oct="-1"] { left: 0.3375rem; }
.octave-btn[data-oct="0"] { left: 1.1875rem; }
.octave-btn[data-oct="1"] { left: 2.0375rem; }
.octave-btn[data-oct="2"] { left: 2.85rem; }

/* Width label alignment */
.width-label {
    position: relative;
    right: .1rem;
}

/* Width control SVG track */
.width-track {
    width: 100%;
    height: auto;
    opacity: 0.8;
    filter: brightness(0);
}

/* Width control handle (draggable circle) */
/* Width control handle (draggable circle) */
.width-handle {
    position: absolute;
    width: 0.4rem;
    height: 0.4rem;
    background-color: #000;
    border-radius: 50%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    cursor: grab;
    box-shadow: var(--control-panel-shadow);
    transition: left 0.1s ease;
    z-index: 10;
}

/* Width handle hover state */
.width-handle:hover {
    transform: translate(-50%, -50%) scale(1.1);
}

/* Width handle active (dragging) state */
.width-handle:active {
    cursor: grabbing;
    transform: translate(-50%, -50%) scale(0.95);
}
